---
phase: 03-tender-discovery
plan: 03
type: execute
wave: 2
depends_on: ["03-01"]
files_modified:
  - src/app/dashboard/tenders/[id]/page.tsx
  - src/app/dashboard/page.tsx
autonomous: false

must_haves:
  truths:
    - "User can view full tender details including requirements, deadlines, and documents"
    - "User can navigate from dashboard to tender discovery"
    - "Tender detail page shows all structured information from the tender record"
  artifacts:
    - path: "src/app/dashboard/tenders/[id]/page.tsx"
      provides: "Tender detail page with full information"
      contains: "getTenderById"
    - path: "src/app/dashboard/page.tsx"
      provides: "Updated dashboard with Browse Tenders link"
      contains: "/dashboard/tenders"
  key_links:
    - from: "src/app/dashboard/tenders/[id]/page.tsx"
      to: "src/lib/tenders/queries.ts"
      via: "import getTenderById"
      pattern: "getTenderById"
    - from: "src/app/dashboard/page.tsx"
      to: "/dashboard/tenders"
      via: "Link component navigation"
      pattern: "/dashboard/tenders"
    - from: "src/app/dashboard/tenders/[id]/page.tsx"
      to: "/dashboard/tenders"
      via: "Back to tenders link"
      pattern: "/dashboard/tenders"
---

<objective>
Build the tender detail page showing full tender information (requirements, deadlines, documents, relevance score) and add dashboard navigation to the tenders section.

Purpose: Deliver the tender detail view (TEND-04 requirement) and connect tender discovery into the main dashboard flow.
Output: Complete tender detail page at /dashboard/tenders/[id] and updated dashboard with Browse Tenders link.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-tender-discovery/03-RESEARCH.md
@.planning/phases/03-tender-discovery/03-01-SUMMARY.md
@prisma/schema.prisma
@src/lib/dal.ts
@src/app/dashboard/page.tsx
@src/app/dashboard/layout.tsx
@src/components/ui/card.tsx
@src/components/ui/badge.tsx
@src/components/ui/button.tsx
@src/components/ui/separator.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create tender detail page and update dashboard</name>
  <files>
    src/app/dashboard/tenders/[id]/page.tsx
    src/app/dashboard/page.tsx
  </files>
  <action>
    1. Create `src/app/dashboard/tenders/[id]/page.tsx`:
       - Server Component (no 'use client')
       - Import verifySession from @/lib/dal
       - Import getTenderById from @/lib/tenders/queries
       - Import notFound from next/navigation (for 404 handling)
       - Import Link from next/link
       - Import Card, CardContent, CardHeader, CardTitle from @/components/ui/card
       - Import Badge from @/components/ui/badge
       - Import Button from @/components/ui/button
       - Import Separator from @/components/ui/separator
       - Import format from date-fns
       - Import ArrowLeft, Calendar, DollarSign, FileText, Target, Clock icons from lucide-react
       - Page receives `params: Promise<{ id: string }>` (Next.js 16 async params)
       - Await params, verify session, fetch tender with getTenderById(params.id, session.userId)
       - If tender is null, call notFound()
       - Layout:
         - **Back link**: "Back to Tenders" with ArrowLeft icon, links to /dashboard/tenders
         - **Header section**: Tender title (h1), sector Badge, status Badge (color-coded: OPEN=green, CLOSED=gray, AWARDED=blue)
         - **Key metrics row** (grid of cards, 3 columns on lg):
           - Estimated Value card: DollarSign icon, formatted EUR value
           - Deadline card: Calendar icon, formatted date, urgency indicator (days remaining, red if < 14, amber if < 30)
           - Relevance card: Target icon, relevance score as percentage with color, "Match to your profile" subtitle
         - **Description section**: Card with tender description (full text, preserving paragraphs)
         - **Requirements section**: Card parsing tender.requirements JSON string:
           - If it has `technical` array: render as "Technical Requirements" list with checkmark icons
           - If it has `certifications` array: render as "Required Certifications" list with Badge components
           - If it has `experience` array: render as "Experience Requirements" list
           - If it has `deliverables` array: render as "Deliverables" list
           - If it has `tags` array: render as "Key Skills" with inline Badges
           - Handle gracefully if requirements is null or malformed JSON (show "No specific requirements listed")
         - **Documents section**: Card parsing tender.documents JSON string:
           - Render each document as a row with FileText icon and document name
           - Documents are mock links (href="#") since this is MVP
           - If documents is null: show "No documents available"
         - **Tender info footer**: Source (e.g., "TED"), Created date, Last updated date
         - Use Separator between major sections for visual clarity

    2. Update `src/app/dashboard/page.tsx`:
       - Add a "Browse Tenders" card/link to the dashboard grid (alongside existing Open Tenders and Your Bids cards)
       - Change the existing "Open Tenders" card to be clickable - wrap it in a Link to /dashboard/tenders
       - Add a visible "Browse Tenders" button below the stats cards grid, using Button component with ArrowRight icon, linking to /dashboard/tenders
       - Import Link from next/link, import ArrowRight from lucide-react
       - Keep all existing dashboard content intact
  </action>
  <verify>
    1. Run `npx tsc --noEmit` for type checking
    2. Run `npm run build` to verify both pages build
    3. Navigate to /dashboard - see Browse Tenders link
    4. Click Browse Tenders - navigate to tenders list
    5. Click a tender title - navigate to detail page
    6. Verify detail page shows all sections (description, requirements, documents, metrics)
    7. Navigate to /dashboard/tenders/nonexistent-id - should show 404
  </verify>
  <done>Tender detail page displays full tender information including parsed requirements, documents, value, deadline with urgency, and relevance score. Dashboard links to tenders section. 404 handling works for invalid tender IDs.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
    Complete tender discovery flow: dashboard link, tender list with filters and sorting, and tender detail page with full information display.
  </what-built>
  <how-to-verify>
    1. Start dev server: `npm run dev`
    2. Log in (demo@bidflow.com / Demo1234!)
    3. On dashboard, verify "Browse Tenders" link/button is visible
    4. Click to navigate to /dashboard/tenders
    5. Verify tender list shows 50+ tenders with title, sector badge, value, deadline, and relevance %
    6. Verify tenders are sorted by relevance (highest first) by default
    7. Test sector filter: select "IT" - only IT tenders shown. Select "Construction" - only Construction shown. Select "All" - all shown.
    8. Test value filter: set min value to 500000 - verify only high-value tenders shown
    9. Test deadline filter: set a future date - verify tenders with earlier deadlines are excluded
    10. Test clear filters button - all filters reset
    11. Click a tender title to open detail page
    12. On detail page verify: title, sector badge, status, value, deadline (with days remaining), relevance score, full description, requirements lists, documents section
    13. Click "Back to Tenders" - returns to list with filters preserved
    14. Try navigating to /dashboard/tenders/fake-id - should show 404 page
  </how-to-verify>
  <resume-signal>Type "approved" or describe any issues to fix</resume-signal>
</task>

</tasks>

<verification>
1. `npm run build` succeeds with no errors
2. /dashboard/tenders/[id] page renders tender details
3. /dashboard page has working link to tenders
4. 404 works for invalid tender IDs
5. Requirements JSON is parsed and displayed correctly
6. All visual elements render properly (badges, cards, icons, urgency colors)
</verification>

<success_criteria>
- Tender detail page shows title, description, sector, value, deadline, status, relevance score
- Requirements section parses JSON and displays categorized lists
- Documents section shows document names
- Deadline urgency indicator works (red < 14 days, amber < 30 days)
- Back navigation to tenders list works
- Dashboard has clear navigation to tender discovery
- 404 handling for invalid tender IDs
- Human verifies complete tender discovery flow works end-to-end
</success_criteria>

<output>
After completion, create `.planning/phases/03-tender-discovery/03-03-SUMMARY.md`
</output>
